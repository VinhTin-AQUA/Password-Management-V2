<div class="relative w-full" (clickOutside)="closeDropdown()">
    <!-- Select Trigger -->
    <div
        class="bg-primary border-primary w-full px-4 py-3 border rounded-lg shadow-sm cursor-pointer transition-all duration-200 ease-in-out hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        [class]="{
            'ring-2 ring-blue-500 border-transparent': isOpen,
            'bg-gray-100 cursor-not-allowed': disabled,
            'border-gray-300': !isOpen && !disabled
        }"
        (click)="toggleDropdown()"
        [attr.disabled]="disabled ? true : null"
    >
        <div class="flex items-center justify-between">
            <div>
                @if(selectedOption?.icon) {
                <span class="text-primary">
                    {{ selectedOption?.icon }}
                </span>
                }

                <span class="text-primary">
                    {{ selectedOption ? selectedOption.label : placeholder }}
                </span>
            </div>

            <!-- Chevron Icon -->
            <svg
                class="text-primary w-5 h-5 transition-transform duration-200 ease-in-out"
                [class.transform.rotate-180]="isOpen"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                />
            </svg>
        </div>
    </div>

    <!-- Dropdown Menu -->
    @if (isOpen) {
    <div
        class="select-primary border-primary absolute z-50 w-full mt-1 border rounded-lg shadow-xl overflow-hidden animate-in fade-in-0 zoom-in-95 duration-200 origin-top"
    >
        <div class="py-1 max-h-60 overflow-auto custom-scrollbar">
            @for (option of options; track $index) {
            <div
                (click)="selectOption(option)"
                class="hover:select-primary-hover px-4 py-2 cursor-pointer transition-all duration-150 ease-in-out"
                [class]="{
                    'bg-blue-50 text-blue-700': option.value === selectedValue,
                    'text-gray-700 hover:bg-gray-100':
                        option.value !== selectedValue && !option.disabled,
                    'text-gray-400 cursor-not-allowed bg-gray-50': option.disabled
                }"
            >
                <div class="text-primary flex items-center justify-between">
                    <div>
                        <span class="truncate">{{ option.icon }} </span>
                        <span class="truncate">{{ option.label }}</span>
                    </div>

                    <!-- Checkmark for selected option -->
                    @if (option.value === selectedValue) {
                        <app-icon name="check"></app-icon>
                    }
                </div>
            </div>
            }

            <!-- Empty state -->
            @if (options.length === 0) {
            <div class="text-primary px-4 py-3 text-center">No options available</div>
            }
        </div>
    </div>
    }
</div>
